# 遅刻罰金アプリ機能一覧

## 📱 アプリ概要
- **コンセプト**: 遅刻したら罰金を課すアプリ（ゲーム感覚）
- **技術スタック**: Flutter + Supabase + 位置情報
- **段階的実装**: ポイント制 → 将来的に実金銭管理へ移行可能

## 🎯 必要機能一覧

### 🔐 認証・ユーザー管理
- [ ] ユーザー登録（メール/パスワード）
- [ ] ログイン/ログアウト
- [ ] プロフィール設定
- [ ] パスワードリセット

### 📍 位置情報・出勤管理
- [ ] 位置情報権限の取得
- [ ] 出勤場所の設定（GPS座標）
- [ ] 出勤範囲の設定（半径何m以内）
- [ ] 出勤時間の設定
- [ ] チェックイン機能（位置情報で自動判定）
- [ ] 手動チェックイン（位置情報取得失敗時）

### ⏰ 時間管理
- [ ] 出勤時間の設定
- [ ] 遅刻判定ロジック
- [ ] 時差対応（タイムゾーン）
- [ ] 休日・祝日設定

### 💰 罰金システム（ポイント制）
- [ ] 遅刻時間に応じたポイント計算
- [ ] 未出勤時のポイント計算
- [ ] ポイント履歴の記録
- [ ] ポイント残高の表示
- [ ] 罰金ルールの設定（管理者用）

### 📊 統計・ランキング
- [ ] 個人の遅刻回数統計
- [ ] 月間/年間の出勤率
- [ ] チーム内ランキング
- [ ] 改善度の可視化

### 🏆 ゲーミフィケーション
- [ ] アチーブメント機能
- [ ] バッジシステム
- [ ] 連続出勤記録
- [ ] ポイント還元システム

### 📱 UI/UX機能
- [ ] ダッシュボード（今日の状況）
- [ ] 出勤履歴一覧
- [ ] 設定画面
- [ ] 通知機能（出勤リマインダー）
- [ ] ダークモード対応

### 🔧 管理機能
- [ ] 管理者ダッシュボード
- [ ] ユーザー管理
- [ ] 罰金ルール設定
- [ ] レポート生成
- [ ] データエクスポート

### 🗄️ データベース設計
- [ ] ユーザーテーブル
- [ ] 出勤記録テーブル
- [ ] 罰金記録テーブル
- [ ] 設定テーブル
- [ ] アチーブメントテーブル

### 🔒 セキュリティ・権限
- [ ] 位置情報の偽装防止
- [ ] 管理者権限の管理
- [ ] データの暗号化
- [ ] API認証

## 🚀 開発優先順位

### Phase 1（MVP）
1. ユーザー認証
2. 位置情報取得
3. 基本的なチェックイン
4. 遅刻判定・ポイント計算
5. 履歴表示

### Phase 2（機能拡張）
1. ゲーミフィケーション
2. 統計・ランキング
3. 通知機能
4. 設定の細分化

### Phase 3（管理機能）
1. 管理者ダッシュボード
2. レポート機能
3. データエクスポート

## 💡 技術的考慮事項

### データベース設計（Supabase）
```sql
-- ユーザーテーブル
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email TEXT UNIQUE NOT NULL,
  name TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 出勤記録テーブル
CREATE TABLE attendance_records (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  check_in_time TIMESTAMP WITH TIME ZONE NOT NULL,
  location_lat DECIMAL(10, 8),
  location_lng DECIMAL(11, 8),
  is_late BOOLEAN DEFAULT FALSE,
  delay_minutes INTEGER DEFAULT 0
);

-- 罰金記録テーブル
CREATE TABLE penalty_records (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  attendance_id UUID REFERENCES attendance_records(id),
  penalty_points INTEGER NOT NULL,
  penalty_reason TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  status TEXT DEFAULT 'pending'
);
```

### 罰金計算ロジック
```dart
int calculatePenalty(Duration delay) {
  if (delay.inMinutes <= 0) return 0; // 遅刻なし
  
  if (delay.inMinutes <= 5) return 10;      // 5分以内：10ポイント
  if (delay.inMinutes <= 15) return 30;    // 15分以内：30ポイント
  if (delay.inMinutes <= 30) return 50;    // 30分以内：50ポイント
  return 100;                              // 30分超：100ポイント
}
```

## 📅 開発スケジュール（想定）

### Week 1-2: 基盤構築
- プロジェクト構造設計
- Supabase設定
- 認証機能実装

### Week 3-4: コア機能
- 位置情報取得
- チェックイン機能
- 遅刻判定ロジック

### Week 5-6: UI/UX
- ダッシュボード
- 履歴表示
- 設定画面

### Week 7-8: ゲーミフィケーション
- ポイントシステム
- ランキング機能
- アチーブメント

---

**作成日**: 2024年10月21日  
**バージョン**: 1.0  
**ステータス**: 企画段階
